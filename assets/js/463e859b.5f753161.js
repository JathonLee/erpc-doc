"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5621],{354:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"guide/http_client","title":"\u65b0\u589e HTTP Client \u8c03\u7528","description":"\u8be5\u7ae0\u8282\u63cf\u8ff0\u5982\u4f55\u6dfb\u52a0 HTTP \u8c03\u7528\u4e0b\u6e38\u670d\u52a1\u5ba2\u6237\u7aef\u4ee3\u7801.","source":"@site/docs/guide/04_http_client.md","sourceDirName":"guide","slug":"/guide/http_client","permalink":"/erpc-doc/docs/guide/http_client","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guide/04_http_client.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"\u65b0\u589e/\u4fee\u6539\u8def\u7531","permalink":"/erpc-doc/docs/guide/modify_route"},"next":{"title":"\u65b0\u589e DB","permalink":"/erpc-doc/docs/guide/new_db"}}');var s=n(4848),o=n(8453);const i={sidebar_position:4},c="\u65b0\u589e HTTP Client \u8c03\u7528",a={},p=[];function d(e){const t={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"\u65b0\u589e-http-client-\u8c03\u7528",children:"\u65b0\u589e HTTP Client \u8c03\u7528"})}),"\n",(0,s.jsx)(t.p,{children:"\u8be5\u7ae0\u8282\u63cf\u8ff0\u5982\u4f55\u6dfb\u52a0 HTTP \u8c03\u7528\u4e0b\u6e38\u670d\u52a1\u5ba2\u6237\u7aef\u4ee3\u7801."}),"\n",(0,s.jsxs)(t.p,{children:["\u5728\u8be5\u76ee\u5f55\uff1a",(0,s.jsx)(t.code,{children:"{\u9879\u76ee\u6839\u76ee\u5f55}/internal/repo/dao"})," \u4e0b\u65b0\u589e ",(0,s.jsx)(t.code,{children:"upstream_service_http.go"})," \u6587\u4ef6."]}),"\n",(0,s.jsx)(t.p,{children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-go",metastring:'title="upstream_service_http.go"',children:'package dao\n\nimport (\n\t"context"\n\tstdhttp "net/http"\n\n\t"{\u9879\u76ee\u540d\u79f0}/internal/repo/model"\n\n\t"talkcheap.xiaoeknow.com/erpc/erpc/http"\n\t"talkcheap.xiaoeknow.com/erpc/erpc/errors"\n)\n\ntype UpstreamServiceHTTP struct {\n    // \u5982\u6709\u8fde\u63a5\u6c60\u914d\u7f6e\u9700\u6c42\uff0c\u53ef\u4ee5\u6dfb\u52a0 client \u5b57\u6bb5\n}\n\nfunc NewUpstreamServiceHTTP() *UpstreamServiceHTTP {\n\treturn &UpstreamServiceHTTP{\n\t\t// \u5982\u6709\u8fde\u63a5\u6c60\u914d\u7f6e\u9700\u6c42\uff0c\u53ef\u4ee5\u6dfb\u52a0 client \u5b57\u6bb5\n\t}\n}\n\n// \u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u8fd4\u56de model \u91cc\u7684 UserInfo \u4fe1\u606f\nfunc (h *UpstreamServiceHTTP) GetUserInfo(ctx context.Context, appID string, id int) (model.UserInfo, error) {\n\tvar resp struct {\n\t\tCode int            `json:"code"`\n\t\tMsg  string         `json:"msg"`\n\t\tData model.UserInfo `json:"data"`\n\t}\n\tif err := http.Post(os.Getenv("LB_SHOP_USER_CENTER_GO")+"/xe.shop.user.info/1.0.0").\n\t\tJson(map[string]any{\n\t\t\t"user_id": id,\n\t\t\t"app_id":  appID,\n\t\t}).\n\t\tSendForJson(ctx, &resp); err != nil {\n\t\treturn false, err\n\t}\n\tif resp.Code != 0 {\n\t\treturn false, errors.New(resp.Code, "\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff1a" + resp.Msg)\n\t}\n\treturn resp.Data, nil\n}\n\n'})})]})}function l(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var r=n(6540);const s={},o=r.createContext(s);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);